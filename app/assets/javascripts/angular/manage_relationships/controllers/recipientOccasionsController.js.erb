(function() {
	
	/**
	 * this controller is specific to the managing relationship within the "Greeting Central" module
	 */
	var app = angular.module('card-queue').controller("recipientOccasionsCtrl", function($rootScope, $scope) {

		// pre-fill for EXISTING OCCASIONS
		$scope.$watch('occasionHash.recipient_occasion.occasion_id', function(newValue, oldValue){
      occasionID = newValue;

      if ($scope.occasionHash) {
      	suggested_date = getDefaultDateForOccasionID(occasionID);

	      // ONLY IF THIS OCCASION HAS NOT ALREADY BEEN SAVED
	      if (!$scope.occasionHash.recipient_occasion.month || (newValue != oldValue)) {
	      	$scope.occasionHash.recipient_occasion.month = suggested_date.month;
	      }

	      if (!$scope.occasionHash.recipient_occasion.day || (newValue != oldValue)) {
	      	$scope.occasionHash.recipient_occasion.day = suggested_date.day;
	      }	
      }
			
     });


		// pre-fill for NEW OCCASION
		$scope.$watch('newRecipientOccasion.recipient_occasion.occasion_id', function(newValue, oldValue){
      occasionID = newValue;

			suggested_date = getDefaultDateForOccasionID(occasionID);

      // ONLY IF THIS OCCASION HAS NOT ALREADY BEEN SAVED
      if (!$scope.newRecipientOccasion.recipient_occasion.month || (newValue != oldValue)) {
      	$scope.newRecipientOccasion.recipient_occasion.month = suggested_date.month;
      }

      if (!$scope.newRecipientOccasion.recipient_occasion.day || (newValue != oldValue)) {
      	$scope.newRecipientOccasion.recipient_occasion.day = suggested_date.day;
      }


     });

	})

})();